Start 
1 Error handler: Try
2 String: Assign “Start” to $sRunningStatus$
3 Log to file “,$sBotName$,----- Start task bot-----,Success” to “$sLogFile$”
4 Datetime: To string Convert $System:Date$ and assign result to $sLogDate$
5 List: Clear all items from $listCannotDownload$
6 Step “Update database”
7 Dictionary: Get value of the key “Execution_Type” from $System:AATaskExecutor$
8 Task Bot: Run “Bots\SSHE Department\SSHE001-Monthly_Report_Waste\Sub Task\SSHE001-001-Update_Database” and assign output to variable
9 Step “Get Config Xpath”
10 Task Bot: Run “Bots\SSHE Department\SSHE001-Monthly_Report_Waste\Sub Task\SSHE001-011-Config_XPath_and_Website” and assign output to variable
11 If string $sRunningStatus_ModuleBot$ Equals to(=) “Complete”
12 Step “Assign  Xpath”
13 Dictionary: Get value of the key “login URL” from $dictXPath_HZW$
14 Dictionary: Get value of the key “Logout URL” from $dictXPath_HZW$
15 Dictionary: Get value of the key “Xpath input login user” from $dictXPath_HZW$
16 Dictionary: Get value of the key “Xpath input login password” from $dictXPath_HZW$
17 Dictionary: Get value of the key “Xpath input submit” from $dictXPath_HZW$
18 Dictionary: Get value of the key “Xpath menu 6th button” from $dictXPath_HZW$
19 Dictionary: Get value of the key “Xpath menu 6th button 2” from $dictXPath_HZW$
20 Dictionary: Get value of the key “Xpath menu G05” from $dictXPath_HZW$
21 Dictionary: Get value of the key “Xpath menu G5.2” from $dictXPath_HZW$
22 Dictionary: Get value of the key “Xpath table permit number” from $dictXPath_HZW$
23 Dictionary: Get value of the key “Xpath Combobox” from $dictXPath_HZW$
24 Dictionary: Get value of the key “Xpath master table HZW” from $dictXPath_HZW$
25 Dictionary: Get value of the key “Xpath view all history detail” from $dictXPath_HZW$
26 Dictionary: Get value of the key “Xpath input start date” from $dictXPath_HZW$
27 Dictionary: Get value of the key “Xpath input end date” from $dictXPath_HZW$
28 Dictionary: Get value of the key “Xpath submit btn” from $dictXPath_HZW$
29 Dictionary: Get value of the key “Xpath table all history detail” from $dictXPath_HZW$
30 Dictionary: Get value of the key “Xpath form method” from $dictXPath_HZW$
31 Dictionary: Get value of the key “Xpath page number button” from $dictXPath_HZW$
32 Dictionary: Get value of the key “Xpath_LogoutBtn” from $dictXPath_HZW$
33 Dictionary: Get value of the key “X Path menu on history page” from $dictXPath_HZW$
34 If: Else
35 Error handler: Throw All Errors
36 Step “Create download folder”
37 If folder does not exist at $sPath_Download$
38 Folder: Create$sPath_Download$
39 Wait for conditionfolder exists at $sPath_Download$
40 Step “Get Data From Web”
41 Excel basic: Open spreadsheet sheet name “Sheet1” as a Read-only mode
42 Loop: For each row in worksheet and assign to $rFactoryData$
43 If ( string $rFactoryData{"Active flag"}$ Equals to(=) “Active” ) and ( string $rFactoryData{User}$ Not equal to(≠) “” ) and ( string $rFactoryData{Password}$ Not equal to(≠) “” ) and ( string $rFactoryData{"Waste Generator ID."}$ Not equal to(≠) “” )
44 Comment “check in rFactoryRecord if Active flag = Active and User != "" and Password != "" and Waste Generator ID. != ""”
45 String: Assign $rFactoryData{User}$ to $sWasteGeneratorID$
46 Error handler: Try
47 Step “Assign  variable & Log file”
48 String: Assign $rFactoryData{"Waste Generator ID."}$ to $sFactoryName$
49 String: Assign “$sPath_Snapshot$/$sLogDate$_Cannot Enter History Page_$sFactory…” to $sLogScreenshot_NotOpenHistoryPage$
50 String: Assign “$sPath_Snapshot$/$sLogDate$_Cannot get permit number_$sFactoryN…” to $sLogScreenshot_NotGetPermitNumber$
51 String: Assign “$sPath_Snapshot$/$sLogDate$_MenuError_$sFactoryName$_$sBotFilen…” to $sLogScreenshot_MenuError$
52 String: Assign “$sPath_Snapshot$/$sLogDate$_LoginError_$sFactoryName$_$sBotFile…” to $sLogScreenshot_LoginError$
53 String: Assign “$sPath_Snapshot$/$sLogDate$_ProgressError_$sFactoryName$_$sBotF…” to $sLogScreenshot_ProgressError$
54 Step “check website open”
55 Comment “close website if found”
56 Error handler: Try
57 Number: Assign 0 to $nCounter$
58 Loopwhile window exists “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณ โรงงานฯ - Google Chrome”
59 Number: Increment $nCounter$ by 1 and assign result to a $nCounter$ variable
60 Log to file “,$sBotName$,Found window การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใ…” to “$sLogFile$”
61 Error handler: Try
62 Window: Close the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
63 Wait for window to close with window title “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ ใช้แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
64 Error handler: Catch All Errors This container is empty.
65 Comment “close website if found”
66 If window exists “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
67 Browser: Closewindow of tab “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออก นอกบริเวณโรงงานฯ”
68 Log to file “,$sBotName$,Close window tab,Success” to “$sLogFile$”
69 Wait for window to close with window title “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ ใช้แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
70 Step “Open Browser”
71 Browser: Open $sURL_Login$
72 Wait for window to open with window title “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
73 Window: Activate the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรง งาน…” window
74 Window: Maximize the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรง งาน…” window
75 Delay: Add a regular delay of 250 milliseconds
76 Step “Login”
77 Comment “enter user password and submit”
78 Recorder: Capture Set text $rFactoryData{User}$ in textbox in the “การ ดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
79 Recorder: Capture Set text from Credential Vault "[$rFactoryData{Password}$]" in password text in the “การดำเนินการเกี่ยวกับ การนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
80 Recorder: Capture Click on button “submit” in the “การดำเนินการเกี่ยวกับการนำ วัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
81 Delay: Add a regular delay of 500 milliseconds
82 Step “G05 Hazardous Waste”
83 Wait for condition “LINK” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists
84 If “LINK” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรง งาน…” exists
86 Step “Click tag menu 6.”
87 Comment “check menu 6. is found”
88 Log to file “,$sBotName$,$sFactoryName$ Login user:$rFactoryData{User}$ Comp…” to “$sLogFile$”
89 Delay: Add a regular delay of 250 milliseconds
90 Loop: 4 times
91 Error handler: Try
92 If number $nClickCounter$ Equals to(=) 1
93 Recorder: Capture Click on link in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
94 If: Else If number $nClickCounter$ Equals to(=) 2
95 Recorder: Capture Click on link “6. การดำเนินการเกี่ยวกับวัสดุที่ไม่ใช้แล้ว (กกอ.)” in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
96 If: Else If number $nClickCounter$ Equals to(=) 3
97 Recorder: Capture Click on link in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
98 If: Else
99 If “LINK” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรง งาน…” exists
100 Simulate keystrokes “[ENTER]” on window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงานฯ”
101 Log to file “,$sBotName$,"Key stroke enter :$sXPath_6thMenu$",Success” to “$sLogFile$”
102 Log to file “,$sBotName$,Click tag 6th :$sXPath_6thMenu$ at click:$nClickCou…” to “$sLogFile$”
103 Loop: Break
104 Error handler: Catch All Errors
105 Log to file “,$sBotName$,"Error Click tag 6th again:$sErrorMessage$ at XPath…” to “$sLogFile$”
106 Loop: Continue
123 Step “Skip pop up”
124 Error handler: Try
125 Delay: Add a regular delay of 3 seconds
126 Simulate keystrokes “[ENTER]” on window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงานฯ”
127 Error handler: Catch All Errors
128 Mouse: Move: Move the mouse pointer from x:1139 y:239 to x:1305 y:467
129 Mouse: Click: Perform the Left Button-Click at the x:1330 y:382 co-ordinates
130 If “BUTTON” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรง งาน…” exists
131 Error handler: Try
132 Recorder: Capture Click on button in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงาน…” window
133 Delay: Add a regular delay of 500 milliseconds
134 Wait for condition “LINK” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists
135 Error handler: Catch All Errors
136 If “BUTTON” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรง งาน…” exists
137 Simulate keystrokes “[ENTER]” on window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงานฯ”
138 Delay: Add a regular delay of 500 milliseconds
139 Wait for condition “LINK” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists
140 If “LINK” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรง งาน…” exists
141 Step “Click menu G05”
142 Delay: Add a regular delay of 100 milliseconds
143 Recorder: Capture Click on link in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
144 Wait for condition “LINK” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists
145 Step “Click menu G5.2”
146 Delay: Add a regular delay of 100 milliseconds
147 Recorder: Capture Click on link in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
148 Wait for condition “COMBOBOX” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงาน…” exists
149 Step “Check Letter Number”
150 If “COMBOBOX” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรง งาน…” exists
151 Recorder: Capture Get number of items from combo box in the “การดำเนินการ เกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window and save as variable '$sTotalLetterNumberItem$'
152 Error handler: Try
153 String: To number Convert string $sTotalLetterNumberItem$ to a number and assign it to number variable $nTotalLetterNumberItem$
154 Log to file “,$sBotName$,$sFactoryName$ Get all Permit number: $nTotalLetter…” to “$sLogFile$”
155 If number $nTotalLetterNumberItem$ Greater Than or Equal To(>=) 1
156 String: Assign “$sPath_Download$/MasterHZW_$sFactoryName$.csv” to $sHZWMaster$
157 If file does not exist at “$sHZWMaster$”
158 Log to file “"User","Waste Type","Permit number","Start date","End date","Wa…” to “$sHZWMaster$”
159 Boolean: Assign True to $bWriteMaster$
160 If: Else
161 Boolean: Assign False to $bWriteMaster$
162 Loop: $nTotalLetterNumberItem$ times
163 Step “Extract License Period”
164 Delay: Add a regular delay of 500 milliseconds
165 Recorder: Capture Select item with index $nTotalLetterNumberItem$ in combo box in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
166 Delay: Add a regular delay of 500 milliseconds
167 Recorder: Capture Get selected text from combo box in the “การดำเนินการเกี่ยว กับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window and save as variable '$sLetterNumber$'
168 Delay: Add a regular delay of 500 milliseconds
169 Recorder: Capture Get property “HTML InnerText” from table in the “การ ดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window and save as variable '$sLicensePeriod$'
170 String: Extract text Source string $sLicensePeriod$: Extract sub-string before “”
171 String: Extract text Source string $sLicensePeriod$: Extract sub-string before “”
172 Log to file “,$sBotName$,"$sFactoryName$ collect Permit number:$sLetterNumbe…” to “$sLogFile$”
173 Delay: Add a regular delay of 1 seconds
174 Step “Get and Write Data to csv”
175 If boolean $bWriteMaster$ Equals to(=) True
176 Recorder: Capture Get entire table for table in the “การดำเนินการเกี่ยวกับการ นำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window and save as variable '$tHZWTable$'
177 Number: Assign 1 to $nTableRowCount$
178 LoopFor each row in table
179 If number $nTableRowCount$ Greater Than (>) 1
180 Step “clean data record”
181 Comment “add ' (single qoute) before text sMethod”
182 String: Assign “'$rHZWRecord[3]$” to $sMethod$
183 Log to file“"$rFactoryData{User}$",HZW,"$sLetterNumber$","'$sLicenseStartDa…” to “$sHZWMaster$”
184 Number: Increment $nTableRowCount$ by 1 and assign result to a $nTableRowCount$ variable
185 Log to file “,$sBotName$,"$sFactoryName$ Permit number:$sLetterNumber$ - Wri…” to “$sLogFile$”
186 If: Else
187 Log to file “,$sBotName$,"$sFactoryName$ Permit number:$sLetterNumber$ - Wri…” to “$sLogFile$”
188 Step “Get all transport history”
189 Step “Prepare History table”
190 String: Assign “$sPath_Download$/HistoryHZW_$sFactoryName$_$sLetterNumber$.csv” to $sHistoryTransportFile$
191 Data Table: Clear contentof data table $tAllHistoryTransport$
192 If file does not exist at “$sHistoryTransportFile$”
193 Step “Click history page”
194 Recorder: Capture Click on link in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
195 Wait for condition( “TEXTBOX” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงาน…” exists ) or ( “TEXTBOX” in window “การดำเนินการ เกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists )
196 If ( “TEXTBOX” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณ โรงงาน…” exists ) or ( “TEXTBOX” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists )
197 Step “Enter page History”
198 Recorder: Capture Set text $sTransportOut_StartDate$ in textbox in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
199 Recorder: Capture Set text $sTransportOut_EndDate$ in textbox “Date_W2” in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
200 Log to file “,$sBotName$,"$sFactoryName$ Permit number:$sLetterNumber$ - Fou…” to “$sLogFile$”
201 Recorder: Capture Click on button in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงาน…” window
202 Wait for condition( “TABLE” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists ) and ( “CLIENT” in window “การดำเนินการเกี่ยวกับ การนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists )
203 Step “Capture Page button”
204 List: Clear all items from $listHistoryPageButton$
205 List: Clear all items from $listPage$
206 Recorder: Capture Get values of all children from client in the “การดำเนิน การเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window and save as variable '$listHistoryPageButton$'
207 List: Size of $listHistoryPageButton$
208 Step “Check button list size and get listPage”
209 If number $nLengthButtonList$ Less Than or Equal To (<=) 3
210 Comment “if lenght of button list <= 3 mean found only 1 page assign listPage = [1]”
211 List: Assign List (1) to $listPage$
212 If: Else
213 Comment “if lenght of button list >3 loop in button list to get page number try convert list item to Number add number to listPage catch continue listPage should be [1, 2, 3, ...] following the page found”
214 Loop: For each item in the list
215 Error handler: Try
216 String: To number Convert string $sListItem$ to a number and assign it to number variable $nListItem$
217 List: Add item $nListItem$ to $listPage$
218 Error handler: Catch All Errors
219 Loop: Continue
220 List: Size of $listPage$
221 Log to file “,$sBotName$,"$sFactoryName$ Permit number:$sLetterNumber$ - Che…” to “$sLogFile$”
222 Step “Get table in each page”
223 Boolean: Assign True to $bNeedHeader$
224 Loop: For each item in the list
225 Error handler: Try
226 Step “click page pbutton”
227 If number $nSizeListPage$ Greater Than or Equal To(>=) 2
228 Recorder: Capture Click on button in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงาน…” window
229 Wait for window to open with window title “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
230 Error handler: Catch All Errors
231 Comment “Skip page button”
232 Error handler: Finally
233 Step “Insert Historytable to tAllHistoryTransport”
234 Recorder: Capture Get entire table for table in the “การดำเนินการเกี่ยวกับการ นำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window and save as variable '$tHistoryTransportData$'
235 Data Table: Get number of rows from data table $tHistoryTransportData$ and assign it to $nTableHistoryRows$
236 Log to file “,$sBotName$,"$sFactoryName$ Permit number:$sLetterNumber$ page:…” to “$sLogFile$”
237 Number: Assign 0 to $nTableRowCount$
238 LoopFor each row in table
239 Number: Increment $nTableRowCount$ by 1 and assign result to a $nTableRowCount$ variable
240 If boolean $bNeedHeader$ Equals to(=) True
241 Comment “insert Header if bNeedHeader = True Then set bNeedHeader = False for skip to add header in next page and continue next iteration”
242 Data Table: Insert rowinto data table $tAllHistoryTransport$ at last position
243 Log to file“"'$rHistoryTransport[0]$","'$rHistoryTransport[1]$","$rHistoryT…” to “$sHistoryTransportFile$”
244 Boolean: Assign False to $bNeedHeader$
245 If ( number $nTableHistoryRows$ Greater Than (>) 2 ) and ( number $nTableRowCount$ Greater Than (>) 1 ) and ( number $nTableRowCount$ Less Than (<) $nTableHistoryRows$ )
246 Comment “insert data if tableRow > 2 rows and tableRowCount > 1 for skip header and tableRowCount < total row for skip footer”
247 Log to file“"'$rHistoryTransport[0]$","'$rHistoryTransport[1]$","$rHistoryT…” to “$sHistoryTransportFile$”
248 Data Table: Insert rowinto data table $tAllHistoryTransport$ at last position
249 Data Table: Get number of rows from data table $tAllHistoryTransport$ and assign it to $nAllHistoryTableRows$
250 Log to file “,$sBotName$,"$sFactoryName$ Permit number:$sLetterNumber$ - Wri…” to “$sLogFile$”
251 Step “Return menu”
252 Recorder: Capture Click on button in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงาน…” window
253 Wait for condition “LINK” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists
254 Step “Click menu G05”
255 Delay: Add a regular delay of 100 milliseconds
256 Recorder: Capture Click on link in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
257 Wait for condition “LINK” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists
258 Step “Click menu G5.2”
259 Delay: Add a regular delay of 100 milliseconds
260 Recorder: Capture Click on link in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” window
261 Wait for condition “COMBOBOX” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงาน…” exists
262 If: Else
263 Step “Add to cannot download list”
264 If checks value exists in $listCannotDownload$.
265 Comment “found waste generator id in list Skip”
266 If: Else
267 List: Add item $sWasteGeneratorID$ to $listCannotDownload$
268 Step “Error not found history page”
269 Screen: Capture desktop screenshot and save the image to “desktop-$sLogScreenshot_NotOpenHistoryPage$”
270 Screen: Capture window application “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออก นอกบริเวณโรงงาน…” screenshot and save the image to “$sLogScreenshot_NotOpenHistoryPage$”
271 Log to file “,$sBotName$,"$sFactoryName$ Permit number:$sLetterNumber$ - Not…” to “$sLogFile$”
272 Log to file “,$sBotName$,"$sFactoryName$ Permit number:$sLetterNumber$ - Not…” to “$sLogFile_Error$”
273 If: Else
274 Log to file “,$sBotName$,"$sFactoryName$ Permit number:$sLetterNumber$ - Fil…” to “$sLogFile$”
275 Error handler: Catch All Errors
276 Step “Progress get data error”
277 Screen: Capture desktop screenshot and save the image to “desktop-$sLogScreenshot_ProgressError$”
278 Screen: Capture window application “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออก นอกบริเวณโรงงาน…” screenshot and save the image to “$sLogScreenshot_ProgressError$”
279 Log to file “,$sBotName$,$sFactoryName$ - Progress get data Error $sErrorMes…” to “$sLogFile$”
280 Log to file “,$sBotName$,$sFactoryName$ - Progress get data Error $sErrorMes…” to “$sLogFile_Error$”
281 Step “Add to cannot download list”
282 If checks value exists in $listCannotDownload$.
283 Comment “found waste generator id in list Skip”
284 If: Else
285 List: Add item $sWasteGeneratorID$ to $listCannotDownload$
286 If: Else
287 Step “Error Cannot get permit number”
288 Screen: Capture desktop screenshot and save the image to “desktop-$sLogScreenshot_NotGetPermitNumber$”
289 Screen: Capture window application “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออก นอกบริเวณโรงงาน…” screenshot and save the image to “$sLogScreenshot_NotGetPermitNumber$”
290 Log to file “,$sBotName$,$sFactoryName$ - Cannot get letter number from Comb…” to “$sLogFile$”
291 Log to file “,$sBotName$,$sFactoryName$ - Cannot get letter number,Fail” to “$sLogFile_Error$”
292 Step “Add to cannot download list”
293 If checks value exists in $listCannotDownload$.
294 Comment “found waste generator id in list Skip”
295 If: Else
296 List: Add item $sWasteGeneratorID$ to $listCannotDownload$
297 If: Else
298 Step “Add to cannot download list”
299 If checks value exists in $listCannotDownload$.
300 Comment “found waste generator id in list Skip”
301 If: Else
302 List: Add item $sWasteGeneratorID$ to $listCannotDownload$
303 Step “Error on menu G05”
304 Screen: Capture desktop screenshot and save the image to “desktop-$sLogScreenshot_MenuError$”
305 Screen: Capture window application “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออก นอกบริเวณโรงงาน…” screenshot and save the image to “$sLogScreenshot_MenuError$”
306 Log to file “,$sBotName$,$sFactoryName$ - Not found menu 6th ,Fail” to “$sLogFile$”
307 Log to file “,$sBotName$,$sFactoryName$ - Not found menu 6th,Fail” to “$sLogFile_Error$”
308 Error handler: Throw All Errors
309 If: Else
310 Step “Error on tag 6. or cannot login”
311 Screen: Capture desktop screenshot and save the image to “desktop-$sLogScreenshot_LoginError$”
312 Screen: Capture window application “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออก นอกบริเวณโรงงาน…” screenshot and save the image to “$sLogScreenshot_LoginError$”
313 Log to file “,$sBotName$,$sFactoryName$ - Cannot Login,Fail” to “$sLogFile$”
314 Log to file “,$sBotName$,$sFactoryName$ - Cannot Login,Fail” to “$sLogFile_Error$”
315 Step “Add to cannot download list”
316 If checks value exists in $listCannotDownload$.
317 Comment “found waste generator id in list Skip”
318 If: Else
319 List: Add item $sWasteGeneratorID$ to $listCannotDownload$
320 Error handler: Catch All Errors
321 Step “Progress error”
322 Screen: Capture desktop screenshot and save the image to “desktop-$sLogScreenshot_ProgressError$”
323 Screen: Capture window application “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออก นอกบริเวณโรงงาน…” screenshot and save the image to “$sLogScreenshot_ProgressError$”
324 Log to file “,$sBotName$,$sFactoryName$ - Progress Error $sErrorMessage$,Fai…” to “$sLogFile$”
325 Log to file “,$sBotName$,$sFactoryName$ - Progress Error $sErrorMessage$,Fai…” to “$sLogFile_Error$”
326 Step “Add to cannot download list”
327 If checks value exists in $listCannotDownload$.
328 Comment “found waste generator id in list Skip”
329 If: Else
330 List: Add item $sWasteGeneratorID$ to $listCannotDownload$
331 Error handler: Finally
332 Step “Logout”
333 Error handler: Try
334 Step “Go to logout page”
335 Browser: Open $sURL_Logout$
336 Wait for window to open with window title “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
337 Step “Click logout button”
338 If “BUTTON” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรง งาน…” exists
339 Recorder: Capture Click on button in the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงาน…” window
340 Wait for condition “TEXTBOX” in window “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงาน…” exists
341 Log to file “,$sBotName$,$sFactoryName$ - Logout,Success” to “$sLogFile$”
342 If: Else
343 Log to file “,$sBotName$,$sFactoryName$ - Not found Logout button ; force lo…” to “$sLogFile$”
344 Step “Close Browser”
345 Error handler: Try
346 If window exists “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
348 Window: Close the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงานฯ” window
349 Wait for window to close with window title “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ ใช้แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
350 Step “Check website open after logout”
351 Comment “close website if found”
352 Error handler: Try
353 If window exists “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
355 Window: Close the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงานฯ” window
356 Wait for window to close with window title “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ ใช้แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
357 Error handler: Finally
358 If window does not exist “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณ โรงงานฯ - Google Chrome”
359 Log to file “,$sBotName$,$sFactoryName$ - Close browser,Success” to “$sLogFile$”
360 Loop: Continue
362 If: Else
363 Log to file “,$sBotName$,$sFactoryName$ - Not match condition: Active accoun…” to “$sLogFile$”
364 Excel basic: Close
365 String: Assign “Complete” to $sRunningStatus$
366 Error handler: Catch All Errors
367 Comment “Error in high level”
368 String: Assign “Fail” to $sRunningStatus$
369 String: Assign “$sPath_Snapshot$/$sLogDate$_BotError_$sBotFilename$.jpg” to $sLogScreenshot_ProgressError$
371 Screen: Capture desktop screenshot and save the image to “desktop-$sLogScreenshot_ProgressError$”
372 Screen: Capture window application “Currently active” screenshot and save the image to “$sLogScreenshot_ProgressError$”
373 Log to file “,$sBotName$,$sFactoryName$ - Error in high level: $sErrorMessag…” to “$sLogFile$”
374 Log to file “,$sBotName$,$sFactoryName$ - Error in high level: $sErrorMessag…” to “$sLogFile_Error$”
375 Error handler: Finally
376 Step “Close Browser”
377 Error handler: Try
378 Wait for window to open with window title “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้ แล้ว ออกนอกบริเวณโรงงานฯ”
379 If window exists “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
380 Window: Close the “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ใช้แล้ว ออกนอกบริเวณโรงงานฯ” window
381 Wait for window to close with window title “การดำเนินการเกี่ยวกับการนำวัสดุที่ไม่ ใช้แล้ว ออกนอกบริเวณโรงงานฯ - Google Chrome”
382 Error handler: Try
383 Wait for window to open with window title /server error\./
384 If window exists /server error\./
385 Window: Close the /server error\. - Google Chrome/ window
386 Wait for window to close with window title /server error\./
387 Step “Log Cannot donwload”
388 Loop: For each item in the list
389 Log to file “,$sBotName$,"Download HZW on user $sWasteGeneratorID$",Fail,"er…” to “$sLogFile$”
390 Step “Update database”
391 Task Bot: Run “Bots\SSHE Department\SSHE001-Monthly_Report_Waste\Sub Task\SSHE001-001-Update_Database” and assign output to variable
392 Log to file “,$sBotName$,----- End task bot-----,Success” to “$sLogFile$”
End 
